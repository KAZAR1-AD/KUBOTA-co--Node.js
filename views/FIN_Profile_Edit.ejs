<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= pageTitle %>（FIN_Profile_Edit）</title>
    <link rel="stylesheet" href="/css/style.css"> 
</head>
<body class="fin-profile-edit">

    <header class="fixed-header">
        <div class="fixed-header-left">
        </div>

        <div class="fixed-header-title">船橋今なにする？</div>

        <div class="fixed-header-icon-area">

            <% if (typeof isLoggedIn !=='undefined' && isLoggedIn) { %>
                <div class="fin001-user-controls">
                    <span class="fin001-welcome-msg">
                        <%= userName %>さん
                    </span>

                    <a href="/mypage" class="header-profile-icon">
                        <img id="headerProfileImage" src="/<%= userIconUrl %>" alt="メニュー">
                    </a>

                    <form action="/logout" method="POST" style="display: inline;"
                        onsubmit="return confirm('ログアウトしますか？');">
                        <button type="submit" class="btn btn-default fin001-logout-btn">ログアウト</button>
                    </form>
                </div>

                <% } else { %>
                    <a href="/welcome?returnUrl=<%= currentUrl %>" class="btn btn-default fin006-register-btn"
                        role="button">
                        ログイン
                    </a>

                    <a href="/FIN003?returnUrl=<%= currentUrl %>" class="btn btn-default fin006-register-btn"
                        role="button">
                        新規登録
                    </a>
                    <% } %>
        </div>
    </header>

    <div class="container fin-profile-edit-container">
        
        <h2><%= pageTitle %></h2> 

        <% if (error) { %>
            <p class="error-message" style="color: red;"><%= error %></p>
        <% } %>

        <form action="/update-<%= mode %>" method="POST">
            
            <div class="form-group">
                <label for="new-value" class="form-label">新しい<%= labelName %></label>
                
                <% 
                    // mode に基づいて input の属性を決定
                    let inputType = (mode === 'email') ? 'email' : 'text';
                    let inputPlaceholder = (mode === 'email') ? 'example@mail.com' : '新しい名前を入力';
                    let inputName = (mode === 'email') ? 'newEmail' : 'newUsername';
                %>
                
                <input 
                    type="<%= inputType %>" 
                    id="new-value" 
                    name="<%= inputName %>" 
                    class="form-input" 
                    placeholder="<%= inputPlaceholder %>" 
                    required>
            </div>

            <div class="button-area">
                <button type="submit" class="btn btn-primary">変更</button>
                <a href="/FIN009" class="btn btn-secondary">戻る</a>
            </div>
        </form>

    </div> </body>
</html>