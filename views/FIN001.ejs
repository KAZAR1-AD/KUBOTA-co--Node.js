<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ページタイトル: サーバーから渡されなければデフォルトを表示 -->
    <title><%= typeof pageTitle !== 'undefined' ? pageTitle : '船橋今なにする？' %></title>
    <!-- CSSのパスは /css/... が正解です -->
    <link rel="stylesheet" href="/css/style.css"> 
</head>
<body class="fin001">

    <header class="fixed-header">
        <!-- 1. 左側のスペース（バランス調整用） -->
        <div class="fixed-header-left">
        </div>

        <!-- 2. 中央のタイトル -->
        <div class="fixed-header-title">船橋今なにする？</div>

        <!-- 3. 右側のアイコンエリア（ここにEJSの分岐を入れます） -->
        <div class="fixed-header-icon-area" id="headerIconArea">
            <% if (typeof isLoggedIn !== 'undefined' && isLoggedIn) { %>
                <!-- ★ログインしている場合：プロフィール画像 -->
                <!-- 画像がない場合はデフォルト画像を表示 -->
                <a href="/FIN008" class="header-profile-icon">
                    <img src="/images/kubota_icon0.png" alt="メニュー" id="ejsProfileImage">
                </a>
            <% } else { %>
                <!-- ★ログインしていない場合：ログインボタン -->
                <a href="/FIN002" class="btn btn-primary header-login-btn">
                    ログイン
                </a>
            <% } %>
        </div>
    </header>

    <main>
        <div class="container fin001-main-container">
            <h1>こんにちは！</h1>
            <div class="button-area button-area-center">
                <a href="/search" class="btn btn-primary fin001-start-btn">
                    はじめる
                </a>
            </div>
        </div>
    </main>

    <!-- プロフィール画像の処理（LocalStorage対応） -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // サーバー側でログイン判定ができているので、ここでの複雑な分岐は不要ですが、
            // 「画像URL」だけはLocalStorageから取ってくる必要がある場合の処理
            const savedImageUrl = localStorage.getItem('profileImage');
            const profileImgTag = document.getElementById('ejsProfileImage');

            // ログインしていて、かつ画像タグがあり、かつ保存された画像がある場合
            if (profileImgTag && savedImageUrl) {
                profileImgTag.src = savedImageUrl;
            }
        });
    </script>
</body>
</html>